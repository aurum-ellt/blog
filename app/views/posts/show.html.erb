<% content_for(:title) { @post.title } %>

<% content_for :head do %>
  <%= auto_discovery_link_tag :atom, author_posts_url(format: :atom), title: "Feed" %>

  <%= tag.meta property: "author", content: @author.name %>
  <%= tag.meta property: "description", content: truncate(@post.body.to_plain_text, length: 250) %>
  <%= tag.meta property: "robots", content: "index, follow" %>

  <%= tag.meta property: "og:site_name", content: "Blog" %>
  <%= tag.meta property: "og:type", content: "article" %>
  <%= tag.meta property: "og:url", content: author_post_url(@author.slug, @post.slug) %>
  <%= tag.meta property: "og:title", content: @post.title %>
  <%= tag.meta property: "og:description", content: truncate(@post.body.to_plain_text, length: 250) %>
  <%= tag.meta property: "og:image", content: @author.avatar.present? ? url_for(@author.avatar) : image_url("user-circle.svg") %>

  <%= tag.meta property: "twitter:title", content: @post.title %>
  <%= tag.meta property: "twitter:description", content: truncate(@post.body.to_plain_text, length: 250) %>
  <%= tag.meta property: "twitter:image", content: @author.avatar.present? ? url_for(@author.avatar) : image_url("user-circle.svg") %>
  <%= tag.meta property: "twitter:card", content: "summary_large_image" %>
<% end %>

<div class="mx-auto md:w-2/3 w-full flex">
  <div class="mx-auto">
    <%= render @post %>

    <%= link_to "Edit this post", edit_post_path(@post), class: "mt-2 rounded-lg py-3 px-5 bg-gray-100 inline-block font-medium" %>
    <%= link_to "Back to posts", author_posts_path(@author.slug), class: "ml-2 rounded-lg py-3 px-5 bg-gray-100 inline-block font-medium" %>
    <div class="flex gap-x-2">
      <%= blog_post_life_cycle_options @post %>
    </div>
    <div class="mt-2" data-controller="clipboard" data-clipboard-success-content-value="Copied!">
      <%= hidden_field_tag :original_url, request.original_url, data: { clipboard_target: "source" } %>
      <button type="button" class="flex gap-x-2" data-action="click->clipboard#copy" data-clipboard-target="button">
        <%= image_tag "link.svg", size: 24 %>
        Copy to clipboard
      </button>
    </div>

    <%= form_with scope: :subscriber, url: author_subscribers_path(@author.slug), class: "contents" do |form| %>
      <div class="my-5">
        <%= form.label :title, "Subscribe to get future posts via email" %>
        <%= form.email_field :email_address, required: true, placeholder: "Enter your email address", class: "block shadow rounded-md border border-gray-400 focus:outline-blue-600 px-3 py-2 mt-2 w-full" %>
      </div>

      <div class="inline">
        <%= form.submit class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer" %>
      </div>
    <% end %>
  </div>
</div>
